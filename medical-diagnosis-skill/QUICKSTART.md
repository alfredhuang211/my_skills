# Quick Start Guide - 快速入门

## 5分钟快速上手

### 1. 技能自动激活

当用户提到以下关键词时，技能会自动激活：

```
✅ 触发词示例：
"我打喷嚏"
"鼻子痒"
"流鼻涕"
"鼻炎怎么办"
"过敏性鼻炎吃什么药"
```

### 2. 基本对话流程（渐进式）

```
用户输入症状（触发）
  ↓
【第1轮】初步症状识别（2题）→ 判断病程
  ↓
【第2轮】鉴别诊断 - 感冒（3题，病程≤7天时）
  ↓
【第3轮】鉴别诊断 - 鼻窦炎（3题）
  ↓
【第4轮】鉴别诊断 - 血管运动性鼻炎（2题）
  ↓
【第5轮】TNSS评分 - 打喷嚏+流涕（2题）
  ↓
【第6轮】TNSS评分 - 鼻痒+鼻塞（2题）
  ↓
【第7轮】病程评估（2题）→ 确定分型
  ↓
【第8轮】特殊情况 - 基本信息（2题，TNSS≥5时）
  ↓
【第9轮】特殊情况 - 合并疾病（2题，按需）
  ↓
【第10轮】特殊情况 - 用药史（2题，有慢性病时）
  ↓
【生成方案】个性化治疗 + 用药指导
  ↓
【购药服务】（可选）分2组收集偏好，匹配链接
  ↓
【随访管理】分组评估改善，智能调整

问题数量：
• 轻度简单：10-12题
• 中度常规：15-18题
• 复杂病例：最多23题
```

### 3. 核心功能一览

| 功能 | 说明 | 示例 |
|------|------|------|
| 🎯 渐进式问诊 | 2-3题一组，避免信息过载 | 每轮提问相关问题，不一次抛出所有 |
| 🔍 鉴别诊断 | 分3轮逐步排除其他疾病 | 第1轮排除感冒→第2轮排除鼻窦炎→第3轮排除血管运动性鼻炎 |
| 🧠 智能决策 | 根据回答决定下一步问什么 | 病程≤7天→询问感冒相关；>7天→跳过 |
| 📊 量化评分 | TNSS评分系统，分2轮询问 | 第1轮：打喷嚏+流涕；第2轮：鼻痒+鼻塞 |
| 🏥 分型诊断 | 间歇性/持续性 + 轻/中/重 | "中度持续性过敏性鼻炎" |
| 💊 用药方案 | 阶梯治疗 + 个性化 | 根据年龄、孕期、疾病调整 |
| 🛒 购药服务 | 分2组收集偏好，智能匹配 | 第1组：价格+品牌；第2组：性状+时效+配送 |
| ⚠️ 安全检查 | 自动识别禁忌症 | 孕妇避免伪麻黄碱 |
| 🚨 危险预警 | 实时检测危险信号 | "呼吸困难"→立即提示就医 |
| 🔄 随访调整 | 分组评估症状改善 | 鼻塞+鼻涕→鼻痒+喷嚏→不良反应 |

## 典型使用场景

### 场景1: 普通成人患者

**输入**: "我最近总是打喷嚏流鼻涕"

**输出**: 
1. 结构化问诊（症状频率、病程、诱因）
2. TNSS评分计算
3. 诊断结果
4. 个性化治疗方案
5. 用药指导

**耗时**: 5-10轮对话

---

### 场景2: 特殊人群（孕妇）

**输入**: "我怀孕了，鼻炎能用药吗？"

**输出**:
1. 孕周确认
2. 症状评估
3. **自动切换孕妇安全方案**
4. FDA分级说明
5. 禁用药物警告

**关键**: 自动识别特殊人群，调整用药

---

### 场景3: 危险信号

**输入**: "我呼吸困难，胸口闷"

**输出**:
```
🚨🚨🚨 立即就医！
可能是哮喘发作，需紧急处理
[详细应急指导]
```

**响应时间**: 立即（优先级最高）

---

### 场景4: 用药随访

**输入**: "我用药一周了,症状好多了"

**输出**:
1. 症状改善评估
2. 前后对比分析
3. **用药方案调整**
4. 后续管理计划

**关键**: 支持动态调整方案

## 技能触发关键词表

### 症状类关键词
```
✅ 高频触发词：
打喷嚏、喷嚏、流鼻涕、清水涕、清涕、鼻涕、
鼻子痒、鼻痒、鼻塞、鼻堵、鼻子堵

✅ 疾病类：
鼻炎、过敏性鼻炎、过敏鼻炎、鼻敏感、鼻子过敏、
季节性鼻炎、常年性鼻炎

✅ 咨询类：
鼻炎怎么办、鼻炎吃什么药、怎么治疗鼻炎、
鼻炎用什么药、过敏性鼻炎治疗
```

### 特殊人群触发
```
✅ 自动识别：
怀孕、孕妇、孕期、哺乳期、喂奶、
儿童、小孩、孩子、宝宝
```

### 危险信号触发
```
🚨 立即响应：
呼吸困难、喘不过气、喘息、胸闷、呼吸急促、
面部肿胀、全身皮疹、意识模糊、
高热不退、剧烈头痛
```

## 测试技能

### 方法1: 运行Python脚本

```bash
cd /Users/alfredhuang/Documents/UGit/AI_Project/my_skills/medical-diagnosis-skill
python3 scripts/ar_diagnosis.py
```

预期输出: 3个测试用例（普通、孕妇、危险信号）

### 方法2: AI对话测试

```
测试输入1: "我打喷嚏流鼻涕"
预期: 激活技能，开始问诊

测试输入2: "我怀孕了，鼻炎能吃药吗"
预期: 识别孕妇，给出安全方案

测试输入3: "我呼吸困难"
预期: 危险信号警告，立即就医
```

## 配置文件说明

### medication_database.json
```json
{
  "nasal_corticosteroids": [...],  // 鼻用激素
  "oral_antihistamines": [...],    // 口服抗组胺
  "nasal_antihistamines": [...],   // 鼻用抗组胺
  ...
}
```

用途: 药物信息库，支持方案生成

### contraindications.json
```json
{
  "special_populations": {
    "pregnancy": {...},  // 孕妇禁忌
    "lactation": {...},  // 哺乳期
    ...
  },
  "comorbidities": {
    "glaucoma": {...},   // 青光眼禁忌
    ...
  }
}
```

用途: 安全用药规则

## 常见问题 FAQ

### Q1: 技能什么时候激活？
**A**: 用户提到2个或以上鼻部症状，或明确提到"鼻炎"、"过敏"等关键词。

### Q2: 如何处理无法诊断的情况？
**A**: 自动提示"无法精准判断，建议转人工问诊或线下就医"。

### Q3: 是否支持其他疾病？
**A**: 当前版本仅支持过敏性鼻炎。未来计划扩展哮喘、荨麻疹等。

### Q4: 用药方案是否合规？
**A**: 基于《中国过敏性鼻炎诊疗指南(2022版)》，但仅供参考，不替代医生诊断。

### Q5: 如何更新知识库？
**A**: 
- 定期更新 `medication_database.json`（新药上市）
- 更新 `SKILL.md`（指南更新）
- 扩展 `ar_diagnosis.py`（新算法）

## 技能优化建议

### 提升问诊效率
```
✅ 使用选择按钮（而非自由输入）
✅ 合并相关问题
✅ 提供典型症状描述
✅ 实时显示评分进度
```

### 增强用户体验
```
✅ 友好的语言风格
✅ 清晰的方案结构
✅ 视觉化评分展示
✅ 分步骤引导
```

### 保障安全性
```
✅ 强制禁忌症检查
✅ 危险信号优先级最高
✅ 特殊人群自动识别
✅ 明确免责声明
```

## 开发者快速参考

### 添加新药物

编辑 `references/medication_database.json`:

```json
{
  "category_name": [
    {
      "name": "药物名称",
      "generic_name": "通用名",
      "dosage": {
        "adult": "成人剂量",
        "child": "儿童剂量"
      },
      "safety_profile": "安全性",
      "price_range": "价格区间"
    }
  ]
}
```

### 添加新禁忌

编辑 `references/contraindications.json`:

```json
{
  "comorbidities": {
    "new_condition": {
      "contraindicated": ["禁用药物列表"],
      "safe": ["安全药物列表"],
      "reason": "原因说明"
    }
  }
}
```

### 扩展诊断算法

编辑 `scripts/ar_diagnosis.py`:

```python
class NewDiseaseDiagnostic:
    @staticmethod
    def classify(symptoms):
        # 实现新的诊断逻辑
        pass
```

## 性能指标

### 预期指标
- **诊断准确率**: >85%（与指南一致性）
- **问诊轮数**: 8-15轮
- **响应时间**: <2秒/轮
- **用户满意度**: >80%

### 监控指标
- 触发准确率
- 禁忌症检出率
- 危险信号识别率
- 方案完整性

## 下一步

### 立即体验
```
1. 复制技能到 skills 目录
2. 对话中输入: "我打喷嚏流鼻涕"
3. 跟随AI引导完成问诊
```

### 深入学习
- 阅读 `SKILL.md` - 完整技能文档
- 查看 `examples/conversation_examples.md` - 对话示例
- 运行 `scripts/ar_diagnosis.py` - 算法测试

### 参与贡献
- 报告bug
- 提交改进建议
- 扩展新疾病支持

---

**开始使用**: 试着说 "我最近打喷嚏流鼻涕" 👃

**需要帮助**: 查看 `README.md` 或 `SKILL.md`

**技术支持**: 查看 `scripts/` 目录下的代码实现
